"""test RC4"""
from os import urandom
from rc4 import RC4

#RFC6229 keys
KEYS1 = [[0x01, 0x02, 0x03, 0x04, 0x05],
         [0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07],
         [0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08],
         [0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a],
         [
             0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b,
             0x0c, 0x0d, 0x0e, 0x0f, 0x10
         ],
         [
             0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b,
             0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16,
             0x17, 0x18
         ],
         [
             0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b,
             0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16,
             0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f, 0x20
         ]]

KEYS2 = [[0x83, 0x32, 0x22, 0x77, 0x2a],
         [0x19, 0x10, 0x83, 0x32, 0x22, 0x77, 0x2a],
         [0x64, 0x19, 0x10, 0x83, 0x32, 0x22, 0x77, 0x2a],
         [0x8b, 0x37, 0x64, 0x19, 0x10, 0x83, 0x32, 0x22, 0x77, 0x2a],
         [
             0xeb, 0xb4, 0x62, 0x27, 0xc6, 0xcc, 0x8b, 0x37, 0x64, 0x19, 0x10,
             0x83, 0x32, 0x22, 0x77, 0x2a
         ],
         [
             0xc1, 0x09, 0x16, 0x39, 0x08, 0xeb, 0xe5, 0x1d, 0xeb, 0xb4, 0x62,
             0x27, 0xc6, 0xcc, 0x8b, 0x37, 0x64, 0x19, 0x10, 0x83, 0x32, 0x22,
             0x77, 0x2a
         ],
         [
             0x1a, 0xda, 0x31, 0xd5, 0xcf, 0x68, 0x82, 0x21, 0xc1, 0x09, 0x16,
             0x39, 0x08, 0xeb, 0xe5, 0x1d, 0xeb, 0xb4, 0x62, 0x27, 0xc6, 0xcc,
             0x8b, 0x37, 0x64, 0x19, 0x10, 0x83, 0x32, 0x22, 0x77, 0x2a
         ]]


def dump(data):
    """This function dump keystream like in RFC"""
    addrs = [
        0, 16, 240, 256, 496, 512, 752, 768, 1008, 1024, 1520, 1536, 2032,
        2048, 3056, 3072, 4080, 4096
    ]

    for addr in addrs:
        print("{:04x}: ".format(addr), end='')
        print(" ".join(f"{val:02x}" for val in data[addr:addr + 16]))


def do_test(key):
    """perfom test"""
    print("key: ", key)
    ciph = RC4(key=key)
    dump(ciph.generate_keystream(4112))


for key in KEYS1:
    do_test(key)
    input()

for key in KEYS2:
    do_test(key)
    input()

